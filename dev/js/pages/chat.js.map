{"version":3,"sources":["chat.jsx"],"names":[],"mappings":"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","file":"chat.js","sourcesContent":["/*jshint sub:true*/\n/*jshint -W030 */\n\n// ChatUI\n//   MatchList\n//     MatchCell\n//   ActiveConvo\n//     ConvoHistoryBox\n//       MessageBubble\n//     MessageInput\n//   ConvoPhotos\n\nfunction ChatClass() {\n  this.url = \"/chat\";\n  this.historyMaxDaysBack = 14;\n  this.init = function(){\n    this.installObservers();\n    this.createReact();\n\t};\n\n  this.sortByDateProp = function(target_list, prop) {\n    return target_list.sort(function(a, b){\n      return Date.parse(b[prop]) - Date.parse(a[prop]);\n    })\n\n  };\n\n  this.createReact = function() {\n    var self = this;\n\n    var ChatUI = React.createClass({\n      loadUpdates: function() {\n        $.ajax({\n          type: \"POST\",\n          url: '/get_history',\n          data: {\n            'timestamp': self.initialFetch\n          },\n          dataType: 'json',\n          success: function(msg) {\n            var timestamp = msg.timestamp;\n            var historyData = self.sortByDateProp(msg.results, 'last_activity_date');\n\n            this.setState({data:historyData});\n            self.lastFetch = timestamp;\n            var currentreact = this;\n\n            if (!self.activeConvoNotSet) {\n              var target_match = this.state.convo['_id'];\n              $.each(historyData, function(idx, val){\n                if(val['_id'] == target_match) {\n                  currentreact.setState({'convo':val});\n                  return false;\n                }\n              });\n            }\n          }.bind(this),\n          error: function(xhr, status, err) {\n            console.error(this.props.url, status, err.toString());\n          }.bind(this)\n        });\n      },\n      getInitialState: function() {\n        return {\n          data:[],\n          convo: {\n            \"_id\":\"\",\n            'messages':[\n              {'from':'', 'message':''}\n            ]\n          }\n        };\n      },\n      historyLooper: function(callback) {\n        var lookup = {\n          \"3\": 7,\n          \"7\": 14,\n          \"14\":20,\n        };\n\n        var current_history = parseInt(self.lastDayFetch);\n        var next = lookup[current_history];\n\n        this.collectHistory(next, function(){\n          callback();\n        });\n\n      },\n      collectHistory: function(days_back, callback) {\n        $.ajax({\n          type: \"POST\",\n          url: '/get_history',\n          data: {\n            'days_ago': parseInt(days_back)\n          },\n          dataType: 'json',\n          success: function(msg) {\n            var timestamp = msg.timestamp;\n            var historyData = self.sortByDateProp(msg.results, 'last_activity_date');\n\n            self.lastFetch = timestamp;\n            self.initialFetch = timestamp;\n            self.lastDayFetch = days_back;\n\n            if(self.activeConvoNotSet) {\n              var currentreact = this;\n              $.each(historyData, function(idx, val){\n                if(val.messages.length>0) {\n                  self.activeConvoNotSet = false;\n\n                  currentreact.setState({\n                    data:historyData,\n                    convo:val\n                  })\n                }\n              });\n              if(self.activeConvoNotSet === true) {\n                this.setState({data:historyData});\n              }\n              callback();\n            } else {\n              this.setState({data:historyData});\n            }\n\n          }.bind(this),\n          error: function(xhr, status, err) {\n            console.error(this.props.url, status, err.toString());\n          }.bind(this)\n        });\n      },\n      quickFetch: function() {\n        this.loadUpdates();\n      },\n      componentDidMount: function() {\n        console.log('mounted');\n        var currentreact = this;\n        $.ajax({\n          type: \"POST\",\n          url: '/get_history',\n          data: {\n            'days_ago': 3\n          },\n          dataType: 'json',\n          success: function(msg) {\n            var timestamp = msg.timestamp;\n            var historyData = msg.results;\n\n            self.lastFetch = timestamp;\n            self.initialFetch = timestamp;\n            self.lastDayFetch = 3;\n            self.activeConvoNotSet = true;\n            $.each(historyData, function(idx, val){\n              if(val.messages.length>0) {\n                self.activeConvoNotSet = false;\n\n                currentreact.setState({\n                  data:historyData,\n                  convo:val\n                })\n              }\n            });\n            if(self.activeConvoNotSet === true) {\n              currentreact.setState({data:historyData});\n            }\n\n            setInterval(this.loadUpdates, 5000);\n\n            var activereact = this;\n            function loop() {\n\n              if(self.lastDayFetch != self.historyMaxDaysBack) {\n                activereact.historyLooper(function(){\n                  loop();\n                });\n              }\n            }\n            loop();\n          }.bind(this),\n          error: function(xhr, status, err) {\n            console.error(this.props.url, status, err.toString());\n          }.bind(this)\n        });\n      },\n      setNewConvo: function(match) {\n        this.setState({convo:match.match});\n      },\n      render: function() {\n        return (\n          <div className=\"chatUI\">\n            <MatchList data={this.state.data} activeConvo={this.state.convo} setNewConvo={this.setNewConvo} />\n            <ActiveConvo triggerHistory={this.quickFetch} match={this.state.convo} />\n            <ConvoPhotos match={this.state.convo} />\n          </div>\n        )\n      }\n    });\n\n    var MatchList = React.createClass({\n      matchChangeHandler: function(match, x) {\n        this.props.setNewConvo({match:x});\n      },\n      render: function() {\n        var currentreact = this;\n        var boundClick = this.matchChangeHandler.bind(null, this);\n        var matchNodes = this.props.data.map(function (match){\n          var last_three_messages = match['messages'].slice(-3);\n          var messaged = true;\n          if(match['messages'].length === 0) {\n            messaged = false\n          }\n          var last_messaged = moment(match.last_activity_date).fromNow();\n          var last_online = moment(match.person.ping_time).fromNow();\n\n          var messages_only = [];\n          $.each(last_three_messages, function(idx, val){\n            messages_only.push(val['message']);\n          });\n          var currently_active = ''\n          if (match._id == currentreact.props.activeConvo._id) {\n            currently_active = 'active'\n          }\n          return (\n            <MatchCell key={match._id}\n              profile={match['person']['photos'][0]['url']}\n              name={match['person']['name']}\n              last_three_messages={messages_only.join('<br />')}\n              messaged={messaged.toString()}\n              last_messaged={last_messaged}\n              last_online={last_online}\n              match_id={match['_id']}\n              match={match}\n              onMatchChange={boundClick}\n              currently_active={currently_active} />\n          );\n        });\n        return  (\n          <div className=\"matchList col-md-4\">\n            {matchNodes}\n          </div>\n        )\n      }\n    });\n\n\n    var MatchCell = React.createClass({\n      handleClick: function(e) {\n        this.props.onMatchChange(this.props.match);\n      },\n      render: function() {\n        var messageExp = this.props.messaged === 'true' ? this.props['last_three_messages'] : 'no messages yet';\n        function createMessage() { return {\n          __html: messageExp\n        };}\n        return (\n          <div className=\"matchCell row\" data-active={this.props.currently_active} onClick={this.handleClick} match_id={this.props['match_id']} messaged={this.props['messaged']}>\n            <img className=\"col-md-4\" src={this.props['profile']} />\n            <div className=\"col-md-8\">\n              <span className=\"name\">{this.props['name']}</span>\n              <span className=\"lastonline\">last online {this.props['last_online']}</span>\n              <p dangerouslySetInnerHTML={createMessage()} />\n            </div>\n          </div>\n        )\n      }\n    });\n\n    var ActiveConvo = React.createClass({\n      handleMessageSubmit: function(message) {\n        this.setState({'submitting': true});\n        var currentreact = this;\n        var DONOTSEND = false;\n\n        if(!DONOTSEND) {\n          $.ajax({\n            type: \"POST\",\n            url: '/send_message',\n            data: {\n              'message': message,\n              \"match_id\": this.props.match._id\n            },\n            dataType: 'json',\n            success: function(msg) {\n              console.log('sent message succesfully');\n              currentreact.setState({\n                'submitting':false,\n                \"last_message\": message\n              });\n              currentreact.props.triggerHistory();\n            }.bind(this),\n            error: function(xhr, status, err) {\n              alert(err.toString());\n              console.error(this.props.url, status, err.toString());\n            }.bind(this)\n          });\n        }\n      },\n      getInitialState: function() {\n        return {\n          \"last_message\": \"\"\n        };\n      },\n      render: function() {\n        if(!this.props.match.hasOwnProperty('person')){\n          return (\n            <div className=\"activeConvo col-md-6\">\n              <div className=\"convoHistoryBox noConvo\">\n                <i className=\"fa fa-spinner fa-spin\"></i>\n              </div>\n            </div>\n          )\n        } else if (this.props.match.messages.length === 0 ) {\n          return (\n            <div className=\"activeConvo col-md-6\">\n              <div className=\"convoHistoryBox\">\n                <h3 className=\"helptext\">Kick off the conversation below!</h3>\n              </div>\n              <MessageInput last_message={this.state.last_message}\n                onMessageSubmit={this.handleMessageSubmit}\n                submitting=''\n                placeholder=\"Enter your message here.\"/>\n            </div>\n          )\n        } else {\n          return (\n          <div className=\"activeConvo col-md-6\">\n            <ConvoHistoryBox match={this.props.match}/>\n            <MessageInput last_message={this.state.last_message}\n              onMessageSubmit={this.handleMessageSubmit}\n              submitting=''\n              placeholder=\"Enter your message here.\" />\n          </div>\n        )\n        }\n      }\n    })\n\n    var ConvoHistoryBox = React.createClass({\n      render: function() {\n\n        var messages = this.props.match['messages'];\n        var m = this.props.match;\n        var started = 'false';\n\n        if(messages.length >0 ) {\n          if(messages[0].from.length > 0) {\n            started = 'true';\n          }\n        }\n        var messageNodes = messages.map(function(message, idx){\n          var from = Global.tinderId == message['from'] ? \"me\" :\"them\";\n          var first = false;\n          if(idx === 0){\n            first = true;\n          } else if(from == 'them') {\n            first = messages[idx-1]['from'] == m.person._id ? false : true;\n          } else if (from == 'me') {\n            first = messages[idx-1]['from'] == Global.tinderId ? false : true;\n          }\n          var their_pic = ''\n          if (m.hasOwnProperty('person')) {\n            their_pic = m.person.photos[0].processedFiles[2].url;\n          }\n\n          var timestamp = ''\n          if(message.hasOwnProperty('sent_date')){\n            var ts = message.sent_date;\n            timestamp = moment(ts).fromNow();\n          }\n\n          return (\n            <MessageBubble key={message._id}\n              from={from}\n              text={message['message']}\n              first={first.toString()}\n              their_pic={their_pic}\n              started={started}\n              timestamp={timestamp} />\n          );\n        });\n        return (\n          <div className=\"convoHistoryBox\">\n            {messageNodes}\n          </div>\n        )\n      }\n    });\n\n    var MessageBubble = React.createClass({\n      render: function() {\n        // var me = Global.tinderId;\n        // var them = x._id;\n        // var from = me == from ? \"me\" :\"them\";\n        return (\n          <div className=\"messageBubble row\" data-first={this.props.first} data-from={this.props.from} data-started={this.props.started}>\n            <div className=\"col-md-1 col-md-offset-1\">\n              <img className=\"mePhoto img-circle\" src={Global.profilePic} />\n            </div>\n            <div className=\"messageText col-md-8\">\n              <p>\n                {this.props.text}\n                <span className=\"messageTimestamp\">{this.props.timestamp}</span>\n              </p>\n            </div>\n            <div className=\"col-md-1\">\n              <img className=\"themPhoto img-circle\" src={this.props.their_pic} />\n            </div>\n          </div>\n        )\n      }\n    });\n\n    var MessageInput = React.createClass({\n      getInitialState: function(){\n        return({\n          \"is_disabled\": \"\",\n          \"submitting\": \"\",\n          \"message_input\": \"\",\n          \"placeholder\": \"Enter your message.\",\n          \"already_reset_for\": \"\",\n          \"attempted_send\": \"\"\n        });\n      },\n      componentWillReceiveProps: function() {\n        if(this.props.last_message==this.state.attempted_send) {\n          if (this.props.last_message != this.state.already_reset_for) {\n            this.setState(this.getInitialState());\n            this.setState({\n              \"already_reset_for\": this.state.last_message\n            })\n          }\n        }\n      },\n      handleChange: function(event) {\n        this.setState({message_input: event.target.value});\n      },\n      messageSubmit: function(e) {\n        e.preventDefault();\n        var msg = this.refs.msg.value.trim();\n\n        if(!msg) {\n          return;\n        }\n        this.setState({\n          \"submitting\": \"submitting\",\n          \"message_input\": \"\",\n          \"placeholder\": \"submitting...\",\n          \"is_disabled\": \"disabled\",\n          \"attempted_send\": msg\n        });\n\n        this.props.onMessageSubmit(msg);\n\n        return;\n      },\n      render: function() {\n        return (\n          <div className=\"messageInput row\">\n            <img className=\"col-md-2\" src={Global.profilePic} />\n\n            <form className=\"messageForm\" onSubmit={this.messageSubmit}>\n              <input disabled={this.state.is_disabled} value={this.state.message_input} type=\"text\" onChange={this.handleChange} ref=\"msg\" className=\"col-md-7\" placeholder={this.state.placeholder} />\n              <button disabled={this.state.is_disabled} type=\"submit\" value=\"\" className=\"submit col-md-3\">\n                <span className=\"default\">submit</span>\n                <i className=\"fa fa-spinner fa-spin\"></i>\n              </button>\n            </form>\n          </div>\n        )\n      }\n    });\n\n    var ConvoPhotos = React.createClass({\n      render: function() {\n        return(\n            <div className=\"convoPhotos\" />\n        )\n      }\n    })\n\n    // REACT RENDER\n\n    ReactDOM.render(\n      <ChatUI data={this.historyData} />,\n      document.getElementById('chat-ui')\n    );  };\n\n\tthis.installObservers = function(){\n\t};\n\n}\n\nvar Chat = new ChatClass();\n\n// MatchList\n//   MatchCell\n"]}